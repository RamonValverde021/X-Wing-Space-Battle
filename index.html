<!DOCTYPE html>
<html lang="pt-br">

<head>
    <meta name="author" content="Ramon Valverde">
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1, viewport-fit=cover">
    <meta name="description" content="Jogo estilo retr√¥ de combate espacial inspirado em StarWars">
    <title>StarWars - X-Wing Space Battle</title>
    <link rel="icon" href="./images/icon-192.png">
    <link rel="manifest" href="./manifest.json">
    <!-- <script language="JavaScript" src="./javascript/script.js" defer></script> -->
    <style>
        @font-face {
            font-family: 'fontPixelArt';
            src: url("./font/ARCADECLASSIC.TTF");
        }

        * {
            /* Resetar modulos de espa√ßamentos*/
            margin: 0px;
            padding: 0px;
            font-family: fontPixelArt;
        }

        body,
        html {
            margin: 0;
            padding: 0;
            overflow: hidden;
            background-color: #000000;
        }

        #tela_jogo {
            position: absolute;
            top: 0;
            left: 0;
            width: 100vw;
            height: 100vh;
            border: none;
        }
    </style>
</head>

<!--
    *Usar uma √∫nica p√°gina e trocar o conte√∫do com JavaScript*

    Essa √© a forma profissional (e usada por praticamente todos os jogos web e PWAs).
    Em vez de abrir novos arquivos .html, voc√™ mant√©m um √∫nico index.html e carrega o conte√∫do dinamicamente via JavaScript.

    Assim o fullscreen continua ativo, porque voc√™ nunca sai do index.html.
    Essa t√©cnica √© o SPA (Single Page Application) ‚Äî usada em frameworks como React, Vue e Angular, mas voc√™ pode fazer na m√£o tamb√©m.

    *Usar um <iframe>

    Se quiser continuar com p√°ginas separadas, d√° pra carregar as outras dentro de um iframe que permanece em fullscreen:
    A√≠ voc√™ s√≥ troca o src do iframe quando quiser mudar de ‚Äúp√°gina‚Äù:

    window.parent.document.getElementById("tela_jogo").src = "./html/intro.html";
-->

<body id="index">

    <iframe id="tela_jogo" src="./html/intro.html"></iframe>

    <script>
        // Registra o Service Worker para funcionalidade PWA e cache offline.
        if ('serviceWorker' in navigator) {                                               // Verifica se o navegador do usu√°rio suporta a tecnologia Service Worker.
            window.addEventListener('load', () => {                                       // Aguarda o evento 'load' da p√°gina, garantindo que o registro n√£o atrase o carregamento inicial.
                navigator.serviceWorker.register('/service-worker.js')                    // Tenta registrar o arquivo do Service Worker, localizado na raiz do projeto.
                    .then(() => console.log("Service Worker registrado com sucesso ‚úÖ")) // Se o registro for bem-sucedido, exibe uma mensagem de sucesso no console.
                    .catch(err => console.error("Erro ao registrar SW:", err, "üö´"));    // Se ocorrer um erro durante o registro, exibe o erro no console.
            });
        }

        // --- L√ìGICA CENTRALIZADA DE MODO IMERSIVO ---

        function isMobile() {
            return /Mobi|Android|iPhone|iPad|iPod/i.test(navigator.userAgent);
        }

        /**
         * Tenta colocar a P√ÅGINA PRINCIPAL em tela cheia imersiva.
         */
        function ativarModoImersivo() {
            console.log("Tentando ativar modo imersivo na p√°gina principal...");
            const el = document.documentElement;
            if (el.requestFullscreen) {
                el.requestFullscreen().then(() => {
                    console.log("Fullscreen ativado na p√°gina principal.");
                    if (screen.orientation && screen.orientation.lock) {
                        screen.orientation.lock('landscape').catch(err => console.error("Falha ao travar orienta√ß√£o:", err));
                    }
                }).catch(err => console.error("Falha ao entrar em tela cheia:", err));
            }
        }

        // Ouve mensagens vindas do iframe
        window.addEventListener('message', (event) => {
            // A verifica√ß√£o de 'origin' √© uma boa pr√°tica de seguran√ßa, mas opcional para localhost/desenvolvimento.
            // if (event.origin !== 'https://sua-url.com') return;

            if (event.data === 'INICIAR_MODO_IMERSIVO') {
                if (isMobile()) {
                    ativarModoImersivo();
                }
            }
        });

    </script>

</body>

</html>